// {{ module | lower }}.entity.ts
// GENERATED BY THE SCRIPT. DO NOT EDIT.

import { Entity, Column, PrimaryGeneratedColumn, CreateDateColumn, UpdateDateColumn{% if entity.relations %}, OneToMany, ManyToOne, OneToOne, ManyToMany, JoinColumn, JoinTable{% endif %} } from 'typeorm';
{%- if entity.relations %}
{%- for relation in entity.relations %}
import { {{ relation.model }} } from '../../{{ relation.model | lower }}/entities/{{ relation.model | lower }}.entity';
{%- endfor %}
{%- endif %}

@Entity('{{ module | lower }}s')
export class {{ module | capitalize }} {
  @PrimaryGeneratedColumn()
  id: number;
{% for field in entity.fields %}
  {%- if field.type == 'enum' %}
  @Column({
    type: 'varchar',
    {%- if field.default is defined %}
    default: '{{ field.default }}',
    {%- endif %}
    {%- if field.unique %}
    unique: true,
    {%- endif %}
  })
  {{ field.name }}: {{ field.enum | map('tojson') | join(' | ') }};
  {%- elif field.type == 'string' %}
  @Column({
    {%- if field.validation and field.validation.maxLength %}
    length: {{ field.validation.maxLength }},
    {%- endif %}
    {%- if not field.required %}
    nullable: true,
    {%- endif %}
    {%- if field.unique %}
    unique: true,
    {%- endif %}
    {%- if field.select is defined and not field.select %}
    select: false,
    {%- endif %}
  })
  {{ field.name }}{% if not field.required %}?{% endif %}: string;
  {%- elif field.type == 'number' %}
  @Column({
    type: 'decimal',
    precision: 10,
    scale: 2,
    {%- if not field.required %}
    nullable: true,
    {%- endif %}
    {%- if field.unique %}
    unique: true,
    {%- endif %}
  })
  {{ field.name }}{% if not field.required %}?{% endif %}: number;
  {%- elif field.type == 'boolean' %}
  @Column({
    {%- if field.default is defined %}
    default: {{ field.default | lower }},
    {%- endif %}
    {%- if not field.required %}
    nullable: true,
    {%- endif %}
  })
  {{ field.name }}{% if not field.required %}?{% endif %}: boolean;
  {%- else %}
  @Column({
    {%- if not field.required %}
    nullable: true,
    {%- endif %}
    {%- if field.unique %}
    unique: true,
    {%- endif %}
  })
  {{ field.name }}{% if not field.required %}?{% endif %}: any;
  {%- endif %}
{% endfor %}
{%- if entity.relations %}
{% for relation in entity.relations %}
  {%- if relation.type == 'OneToMany' %}
  @OneToMany(() => {{ relation.model }}, {{ relation.model | lower }} => {{ relation.model | lower }}.{{ relation.inverseField | default(relation.field) }})
  {{ relation.field }}{% if not relation.required %}?{% endif %}: {{ relation.model }}[];
  {%- elif relation.type == 'ManyToOne' %}
  @ManyToOne(() => {{ relation.model }}{% if relation.inverseField %}, {{ relation.model | lower }} => {{ relation.model | lower }}.{{ relation.inverseField }}{% endif %}{% if relation.onDelete %}, { onDelete: '{{ relation.onDelete }}' }{% endif %})
  {%- if relation.joinColumn %}
  @JoinColumn({ name: '{{ relation.joinColumn }}' })
  {%- endif %}
  {{ relation.field }}{% if not relation.required %}?{% endif %}: {{ relation.model }};
  {%- elif relation.type == 'OneToOne' %}
  @OneToOne(() => {{ relation.model }}{% if relation.inverseField %}, {{ relation.model | lower }} => {{ relation.model | lower }}.{{ relation.inverseField }}{% endif %}{% if relation.onDelete %}, { onDelete: '{{ relation.onDelete }}' }{% endif %})
  {%- if relation.joinColumn %}
  @JoinColumn({ name: '{{ relation.joinColumn }}' })
  {%- endif %}
  {{ relation.field }}{% if not relation.required %}?{% endif %}: {{ relation.model }};
  {%- elif relation.type == 'ManyToMany' %}
  @ManyToMany(() => {{ relation.model }}{% if relation.inverseField %}, {{ relation.model | lower }} => {{ relation.model | lower }}.{{ relation.inverseField }}{% endif %})
  {%- if relation.joinTable %}
  @JoinTable()
  {%- endif %}
  {{ relation.field }}{% if not relation.required %}?{% endif %}: {{ relation.model }}[];
  {%- endif %}
{% endfor %}
{%- endif %}

  @CreateDateColumn()
  createdAt: Date;

  @UpdateDateColumn()
  updatedAt: Date;
}
